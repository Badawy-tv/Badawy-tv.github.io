<!DOCTYPE html>
<html>
<head>
<title>Badawy TV Creator Studio</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database-compat.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{margin:0;font-family:Segoe UI;background:#f5f7fb;}
.topbar{height:60px;background:white;display:flex;align-items:center;justify-content:space-between;padding:0 20px;box-shadow:0 2px 6px rgba(0,0,0,0.05);}
.sidebar{width:220px;background:white;height:100vh;position:fixed;top:60px;left:0;box-shadow:2px 0 6px rgba(0,0,0,0.05);padding-top:20px;}
.sidebar button{display:block;width:100%;padding:12px 20px;border:none;background:none;text-align:left;cursor:pointer;font-size:15px;}
.sidebar button:hover{background:#f0f2f5;}
.content{margin-left:220px;margin-top:60px;padding:30px;}
.card{background:white;padding:20px;border-radius:12px;box-shadow:0 4px 15px rgba(0,0,0,0.05);margin-bottom:20px;}
.login-wrapper{display:flex;justify-content:center;align-items:center;height:100vh;}
.login-card{background:white;padding:40px;width:350px;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,0.08);}
input,textarea{width:100%;padding:10px;margin:10px 0;border-radius:8px;border:1px solid #ddd;}
button{padding:10px;border:none;border-radius:8px;background:#1877f2;color:white;font-weight:bold;cursor:pointer;}
.dashboard{display:none;}
</style>
</head>
<body>

<div class="login-wrapper" id="loginBox">
<div class="login-card">
<h2>Admin Login</h2>
<form onsubmit="login(event)" autocomplete="on">
<input id="email" type="email" autocomplete="email" required>
<input id="password" type="password" autocomplete="current-password" required>
<button type="submit">Login</button>
</form>
<p id="msg"></p>
</div>
</div>

<div class="dashboard" id="dashboard">

<div class="topbar">
<div><strong>Badawy TV Professional Dashboard</strong></div>
<div id="liveTop"></div>
</div>

<div class="sidebar">
<button onclick="showSection('overview')">Overview</button>
<button onclick="showSection('upload')">Upload Media</button>
<button onclick="logout()">Logout</button>
</div>

<div class="content">

<div id="overview" class="card">
<h2>Live Analytics</h2>
<canvas id="liveChart"></canvas>
</div>

<div id="upload" class="card" style="display:none;">
<h2>Upload Photo</h2>
<input type="file" id="fileInput" accept="image/*">
<button onclick="uploadFile()">Upload</button>
<p id="uploadStatus"></p>
</div>

</div>
</div>

<script>
const firebaseConfig = {
apiKey: "AIzaSyASNJLrmw3pk9ClzYeFUyu4fq_AqO4Wkjc",
authDomain: "badawytv.firebaseapp.com",
databaseURL: "https://badawytv-default-rtdb.firebaseio.com",
projectId: "badawytv"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();

auth.onAuthStateChanged(user=>{
if(user){
loginBox.style.display="none";
dashboard.style.display="block";
loadAnalytics();
}
});

function login(e){
e.preventDefault();
auth.signInWithEmailAndPassword(email.value,password.value)
.catch(error=>msg.innerText=error.message);
}

function logout(){
auth.signOut().then(()=>location.reload());
}

function showSection(id){
document.querySelectorAll('.content .card')
.forEach(c=>c.style.display='none');
document.getElementById(id).style.display='block';
}

function loadAnalytics(){
db.ref("liveStatus").on("value",snap=>{
const live = snap.val() ? 1 : 0;
const offline = snap.val() ? 0 : 1;

new Chart(document.getElementById('liveChart'),{
type:'bar',
data:{
labels:['Live','Offline'],
datasets:[{
label:'Stream Status',
data:[live,offline]
}]
}
});
});
}

function uploadFile(){
const file = document.getElementById("fileInput").files[0];
if(!file){return;}

const reader = new FileReader();
reader.onload = function(e){
db.ref("posts").push({
image:e.target.result,
timestamp:Date.now()
});
uploadStatus.innerText="Uploaded successfully!";
};
reader.readAsDataURL(file);
}
</script>

</body>
</html>
